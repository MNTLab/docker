node('docker') {
    stage ('Building image'){
	git branch: 'nikita_dolya_day2', url: 'https://github.com/bubalush/docker.git'
    def gradle = docker.build ('gradle', '-f gradle.Dockerfile .')
}
    stage ('Build app'){
    docker.image('gradle:latest').inside {
        sh 'gradle build'
    	}
	}
	stage ('Deploy jar'){
	        sh 'pwd'
            sh 'docker-compose up -d'
    	}
	
	stage ('Test jar'){
            sh 'curl  -s -IL http://127.0.0.1:8081 | grep "200"'
    	}
	
}